#!/usr/bin/env bash
# Install nix and packages managed by nix.

set -e

echo "Configuring the nix package manager."

# Get nix if necessary.
if [ ! -e "${USER_NIX_PROFILE}/bin/nix-env" ]; then
  echo "Installing the nix package manager."
  curl "https://nixos.org/nix/install" | sh
fi

echo "Restart the shell."
exit

# load the nix profile
if [ -e "${USER_NIX_PROFILE}" ]; then
  source "${USER_NIX_PROFILE}"
else
  # The daemon needs to run for existing shells to use nix.
  source /nix/var/nix/profiles/default/etc/profile.d/nix-daemon.sh
fi

# Install common packages as defined in ~/.nixpkgs/config.nix
echo "Installing nix packages."
echo "For now, skipping package installation. Consider using upkg."
#   nix-env --install --attr nixpkgs.all

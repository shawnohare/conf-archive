#!/usr/bin/env bash
# ---
# Install golang for macos or linux. Ideally this should be handled by a
# package manager such as nix, but it appears there's some hoops to jump
# through to develop in go using the compiler provided by nix.
# WARNING: This script completely removes old installations of golang.
# ---

readonly version="${VERSION:-1.9.1}"
readonly arch="${ARCH:-amd64}"
os="${OS:-$(uname -s)}"
# Lower first character.
os="${os,}"

readonly src="go${version}.${os}-${arch}.tar.gz"
readonly path="${HOME}/tmp/${src}"
[[ -e "${path}" ]] || wget "https://storage.googleapis.com/golang/${src}" -O "${path}"
sudo rm -rf "/usr/local/go"
sudo tar -C "/usr/local" -xzf "${path}"

